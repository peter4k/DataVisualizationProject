<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1"/>
    <meta name="description" content="Datavisualizationproject : cs490/cs690"/>

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Datavisualizationproject</title>


</head>

<body>

<script src="alex/d3.min.js"></script>
<script src="javascripts/scatterplot.js"></script>
<script src="javascripts/piechart.js"></script>
<script src="javascripts/scatterplotMatrix.js"></script>
<script src="javascripts/line.js"></script>


<!-- HEADER -->
<div id="header_wrap" class="outer">
    <header class="inner">
        <a id="forkme_banner" href="https://github.com/azepeda2/DataVisualizationProject">View Source Code</a>

        <h1 id="project_title">US College Information System</h1>
    </header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
    <section id="main" class="svg">

        <form>
            <label><input id="pieradio" type="radio" name="dataset" value="scatterplot" checked> Scatter plot</label>
            <label><input id="pieradio" type="radio" name="dataset" value="pie"> Pie Chart</label>
            <label><input id="pieradio" type="radio" name="dataset" value="spm"> Scatterplot Matrix</label>
            <label><input id="pieradio" type="radio" name="dataset" value="lines"> Multiply Line Chart</label>
            <label><input id="pieradio" type="radio" name="dataset" value="map"> map</label>
        </form>
        <hr/>

        <div id="selection">

        </div>
        <table>
            <tr>
                <td id="svgtd" width="800"></td>
                <td valign="top">
                    <table valign="top">
                        <tr>
                            <td>
                                <form name="schoolname">
                                    <input type="text" name="name"/>
                                    <input type="button" name="button" value="search" onclick="search()"/>
                                </form>
                            </td>
                        </tr>
                        <td id="selectedschools"></td>
                        <tr></tr>
                    </table>
                </td>
            </tr>
        </table>

        <script>

            var data;
            var schoolnames = new Array();

            d3.selectAll("#pieradio")
                    .on("change", formchange);

            function formchange() {
                var value = this.value;

                if (value == "lines") {
                    deleteSvg();
                    line();
                }

                if (value == "pie") {
                    deleteSvg();
                    piechart();
                }

                if (value == "scatterplot") {
                    deleteSvg();
                    scatterplot();
                }
                if (value == "spm") {
                    deleteSvg();
                    createSPM();
                }
                if (value == "map") {
                    window.location.href="http://azepeda2.github.io/DataVisualizationProject/MAP.html";
                }
            }

//            selectData();
            scatterplot();

            function deleteSvg() {
                d3.select("#mainsvg").remove();
            }

            function selectData() {

                d3.csv("data/top50with5categories.csv", function (error, dataset) {

                    // ensures data from csv is interpreted as int
                    dataset.forEach(function (d) {
                        d.tuition03_tf = +d.tuition03_tf;
                        d.tot_rev_w_auxother_sum = +d.tot_rev_w_auxother_sum;
                        d.control = +d.control;
                        d.total_enrollment = +d.total_enrollment;
                        d.all_employees = +d.all_employees;
                    });

                    data = dataset;

                    updateChart(data);
                });
            }

            function loadData() {

                d3.csv("data/top50with5categories.csv", function (error, dataset) {

                    var tempdata = new Array();
                    // ensures data from csv is interpreted as int
                    dataset.forEach(function (d) {
                        schoolnames.forEach(function (n){
                            if(d.instname == n){
                                console.log("yes");
                                d.tuition03_tf = +d.tuition03_tf;
                                d.tot_rev_w_auxother_sum = +d.tot_rev_w_auxother_sum;
                                d.control = +d.control;
                                d.total_enrollment = +d.total_enrollment;
                                d.all_employees = +d.all_employees;
                                tempdata.push(d);
                            }
                        })
                    });

                    console.log(tempdata.length);
                    data = tempdata;

                    updateChart(data);
                });
            }

            function search() {
                var name = schoolname.name.value;
                schoolnames.push(name);

                var text;
                for (var i = 0; i < schoolnames.length; i++) {
                    text = text + "<br>" + schoolnames[i];
                }
                document.getElementById("selectedschools").innerHTML = text;
                loadData();
                updateChart(data);
            }

        </script>


    </section>
</div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
    <footer class="inner">
        <p class="copyright">Datavisualizationproject maintained by <a href="https://github.com/azepeda2">azepeda2</a>
        </p>

        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
    </footer>
</div>


</body>
</html>
